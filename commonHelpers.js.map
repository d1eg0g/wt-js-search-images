{"version":3,"file":"commonHelpers.js","sources":["../src/js/api.js","../src/js/lightbox.js","../src/js/pagination.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '41357057-faf3d010336ad7b1d27d71654';\nconst BASE_URL = 'https://pixabay.com/api/';\nconst DEFAULT_PER_PAGE = 40;\n\nfunction apiService() {\n  const service = {\n    searchQuery: '',\n    page: 1,\n    PER_PAGE: DEFAULT_PER_PAGE,\n  };\n\n  const fetchGallery = async () => {\n    try {\n      const response = await axios.get(BASE_URL, {\n        params: {\n          key: API_KEY,\n          q: service.searchQuery,\n          image_type: 'photo',\n          orientation: 'horizontal',\n          safesearch: true,\n          page: service.page,\n          per_page: service.PER_PAGE,\n        },\n      });\n      return response.data;\n    } catch (error) {\n      console.error(error);\n      throw new Error('Failed to fetch data');\n    }\n  };\n\n  const incrementPage = () => {\n    service.page += 1;\n  };\n\n  const resetPage = () => {\n    service.page = 1;\n  };\n\n  const getQuery = () => {\n    return service.searchQuery;\n  };\n\n  const setQuery = (newQuery) => {\n    service.searchQuery = newQuery;\n    resetPage();\n  };\n\n  const getPage = (currentPage) => {\n    service.page = currentPage;\n  };\n\n  return {\n    fetchGallery,\n    incrementPage,\n    resetPage,\n    getQuery,\n    setQuery,\n    getPage,\n  };\n}\n\nexport default apiService();","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nlet lightbox = new SimpleLightbox('.photo-card a', {\n  captions: true,\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nexport { lightbox };","import apiService from './api';\nimport { lightbox } from './lightbox';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst searchButton = document.getElementById('search-button');\nconst galleryContainer = document.querySelector('.gallery');\nconst searchQueryInput = document.getElementById('search-bar');\nconst paginationContainer = document.getElementById('pagination-container')\nconst paginationButtons = document.getElementById('pagination-numbers');\nconst prevButton = document.getElementById('prev-button');\nconst nextButton = document.getElementById('next-button');\n\nlet isShown = 0;\nlet isFirstSearch = true;\nlet currentPage = 1;\nlet query = ''\n\nsearchButton.addEventListener(\"click\", function(event) {  \n  event.preventDefault();\n  onSearch();\n  isFirstSearch = true;\n  currentPage = 1;\n});\n\nsearchQueryInput.addEventListener(\"keydown\", function(event) {\n  if (event.key === 'Enter') {\n    event.preventDefault();\n    onSearch();\n  }\n  isFirstSearch = true; \n  currentPage = 1;\n});\n\nprevButton.addEventListener('click', () => setCurrentPage(currentPage - 1));\nnextButton.addEventListener('click', () => setCurrentPage(currentPage + 1));\n\nasync function onSearch() {\n  const searchQuery = searchQueryInput.value.trim();\n  \n  apiService.setQuery(searchQuery); \n\n  if (searchQuery === '') {\n    showToast('warning', 'Будь ласка, заповніть поле пошуку');\n    paginationContainer.classList.add('is-hidden')\n    return;\n  }\n\n  if (searchQuery === query) {    \n    showToast('warning', 'Будь ласка, змініть або введіть нове значення для пошуку.');\n    return;\n  }  \n  \n  apiService.resetPage();  \n  query = searchQuery;\n  isShown = 0;\n  await fetchGallery(1);\n}\n\nasync function fetchGallery(currentPage) {\n  try {    \n    apiService.getPage(currentPage)\n    const result = await apiService.fetchGallery();    \n    const { hits, totalHits } = result;\n\n    if (isFirstSearch && !hits.length) {\n      showToast('error', 'Вибачте, немає зображень, які відповідають вашому пошуковому запиту. Будь ласка спробуйте ще раз.');\n      paginationContainer.classList.add('is-hidden')\n      return;\n    }\n\n    if (isFirstSearch && isShown < totalHits) {\n      showToast('success', `Ура! Ми знайшли ${totalHits} зображень!`);\n      setupPagination({ hits, totalHits });\n      isFirstSearch = false;      \n    }\n\n    galleryContainer.innerHTML = '';\n    onRenderGallery(hits);    \n    isShown += hits.length;\n\n    if (isFirstSearch && isShown >= totalHits) {\n      showToast('info', \"Ви досягли кінця результатів пошуку.\");      \n    }\n  } catch (error) {\n    console.error('Error fetching gallery:', error);\n    showToast('error', 'Під час отримання галереї зображень сталася помилка.');\n  }\n}\n\nfunction onRenderGallery(elements) {\n  const markup = elements\n    .map(({ webformatURL, largeImageURL, tags, likes, views, downloads }) => `\n      <div class=\"photo-card\">\n        <a href=\"${largeImageURL}\">\n          <img class=\"photo-img\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\" />\n        </a>\n        <div class=\"info\">\n          <p class=\"info-item\"><b>Вподобайки</b><span class=\"info__span\">${likes}</span></p>\n          <p class=\"info-item\"><b>Перегляди</b><span class=\"info__span\">${views}</span></p>\n          <p class=\"info-item\"><b>Завантаження</b><span class=\"info__span\">${downloads}</span></p>\n        </div>\n      </div>`\n    )\n    .join('');\n\n  galleryContainer.insertAdjacentHTML('beforeend', markup);\n  lightbox.refresh();\n}\n\nfunction setupPagination({ hits, totalHits }) {\n  \n  const pageCount = Math.ceil(totalHits / hits.length); \n  \n  paginationButtons.innerHTML = '';\n\n  for (let i = 1; i <= pageCount; i++) {\n    const pageNumber = document.createElement('button');\n    pageNumber.className = 'pagination-number';\n    pageNumber.textContent = i;\n\n    paginationButtons.appendChild(pageNumber);\n\n    pageCount > 1 ? paginationContainer.classList.remove('is-hidden') : paginationContainer.classList.add('is-hidden')\n\n    pageNumber.addEventListener('click', () => {\n      setCurrentPage(i);\n      isFirstSearch = false; \n    });    \n  }\n  handlePageButtonsStatus();\n  handleActivePageNumber();  \n}\n\nasync function setCurrentPage(i) {\n  currentPage = i; \n  await fetchGallery(currentPage);\n  scrollToTop();\n  handlePageButtonsStatus();\n  handleActivePageNumber();  \n}\n\nconst disableButton = (button) => {\n  button.classList.add(\"disabled\");\n  button.setAttribute(\"disabled\", true);\n};\n\nconst enableButton = (button) => {\n  button.classList.remove(\"disabled\");\n  button.removeAttribute(\"disabled\");\n};\n\nconst handlePageButtonsStatus = () => {  \n  if (currentPage === 1) {\n    disableButton(prevButton);\n  } else {\n    enableButton(prevButton);\n  }\n\n  if (currentPage === paginationButtons.children.length) {\n    disableButton(nextButton);\n  } else {\n    enableButton(nextButton);\n  }\n};\n\nconst handleActivePageNumber = () => {  \n  document.querySelectorAll(\".pagination-number\").forEach((button, page) => {\n    button.classList.remove(\"active\");    \n    if (page + 1 === currentPage) {\n      button.classList.add(\"active\");\n    }\n  });\n};\n\nfunction showToast(type, message) {\n  iziToast[type]({\n    title: type.charAt(0).toUpperCase() + type.slice(1),\n    message: message,\n    position: 'topRight',\n    color: type === 'success' ? 'green' : type === 'warning' ? 'yellow' : type === 'error' ? 'red' : 'blue',\n    timeout: 2000,\n    closeOnEscape: true,\n    closeOnClick: true,\n  });\n}\n\nfunction scrollToTop() {\n  window.scrollTo({\n    top: 0,\n    behavior: 'auto',\n  });\n}"],"names":["API_KEY","BASE_URL","DEFAULT_PER_PAGE","apiService","service","fetchGallery","axios","error","incrementPage","resetPage","newQuery","currentPage","apiService$1","lightbox","SimpleLightbox","searchButton","galleryContainer","searchQueryInput","paginationContainer","paginationButtons","prevButton","nextButton","isShown","isFirstSearch","query","event","onSearch","setCurrentPage","searchQuery","showToast","result","hits","totalHits","setupPagination","onRenderGallery","elements","markup","webformatURL","largeImageURL","tags","likes","views","downloads","pageCount","i","pageNumber","handlePageButtonsStatus","handleActivePageNumber","scrollToTop","disableButton","button","enableButton","page","type","message","iziToast"],"mappings":"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"}